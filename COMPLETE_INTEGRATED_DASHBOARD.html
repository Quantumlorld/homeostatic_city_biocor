<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåô COMPLETE HOMEOSTATIC CITY BIOCORE SYSTEM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #16213e 100%);
            color: white;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #4CAF50, #9C27B0, #2196F3, #FF9800);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: rainbow-glow 4s ease-in-out infinite;
        }

        @keyframes rainbow-glow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .system-status {
            position: absolute;
            top: 10px;
            right: 20px;
            background: rgba(76, 175, 80, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #4CAF50;
            font-size: 0.9rem;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.3s ease;
        }

        .panel:hover {
            transform: translateY(-2px);
        }

        .panel h2 {
            color: #64B5F6;
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4CAF50;
            animation: sparkle 1.5s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        .zones-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .zone-card {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .zone-card:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .zone-id {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .zone-name {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .zone-activity {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .zone-state {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .state-calm { background: #4CAF50; color: white; }
        .state-overstimulated { background: #FF9800; color: white; }
        .state-emergent { background: #f44336; color: white; }

        .luna-chat {
            background: rgba(156, 39, 176, 0.1);
            border: 1px solid rgba(156, 39, 176, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .chat-messages {
            height: 300px;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .message {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 10px;
        }

        .user-message {
            background: rgba(33, 150, 243, 0.2);
            text-align: right;
        }

        .luna-message {
            background: rgba(156, 39, 176, 0.2);
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 25px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 1rem;
        }

        .chat-input button {
            padding: 12px 25px;
            background: linear-gradient(45deg, #9C27B0, #2196F3);
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .chat-input button:hover {
            transform: scale(1.05);
        }

        .biocore-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .control-button {
            padding: 15px;
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .control-button:hover {
            background: rgba(76, 175, 80, 0.4);
            transform: translateY(-2px);
        }

        .system-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .metric-card {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #64B5F6;
        }

        .metric-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .action-button {
            padding: 15px 30px;
            background: linear-gradient(45deg, #4CAF50, #2196F3);
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .action-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåô COMPLETE HOMEOSTATIC CITY BIOCORE SYSTEM</h1>
            <div class="system-status">
                <span class="status-indicator"></span>
                SYSTEM ACTIVE
            </div>
        </div>

        <div class="main-grid">
            <!-- BHCS ZONES PANEL -->
            <div class="panel">
                <h2><span class="status-indicator"></span> BHCS ZONES</h2>
                <div class="zones-grid" id="zones-grid">
                    <!-- Zones will be populated by JavaScript -->
                </div>
            </div>

            <!-- LUNA AI CHAT PANEL -->
            <div class="panel">
                <h2><span class="status-indicator"></span> LUNA AI CHAT</h2>
                <div class="luna-chat">
                    <div class="chat-messages" id="chat-messages">
                        <div class="message luna-message">
                            üåô Hello! I'm Luna, your AI assistant for the Homeostatic City BioCore System. I can help you monitor zones, apply BioCore effects, and optimize the system. How can I assist you today?
                        </div>
                    </div>
                    <div class="chat-input">
                        <input type="text" id="chat-input" placeholder="Ask Luna about the system..." />
                        <button onclick="sendMessage()">Send</button>
                    </div>
                </div>
            </div>

            <!-- SYSTEM METRICS PANEL -->
            <div class="panel">
                <h2><span class="status-indicator"></span> SYSTEM METRICS</h2>
                <div class="system-metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="system-health">0.85</div>
                        <div class="metric-label">System Health</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="active-zones">5</div>
                        <div class="metric-label">Active Zones</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="biocore-effects">0</div>
                        <div class="metric-label">BioCore Effects</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="luna-interactions">0</div>
                        <div class="metric-label">Luna Interactions</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BIOCORE CONTROLS PANEL -->
        <div class="panel">
            <h2><span class="status-indicator"></span> BIOCORE CONTROLS</h2>
            <div class="biocore-controls">
                <div class="control-button" onclick="applyBioCore(0, 'Ashwagandha', 'DrugA', 0.8)">
                    <strong>üåø Ashwagandha + DrugA</strong><br>
                    <small>Calming Effect (Synergy: 0.8)</small>
                </div>
                <div class="control-button" onclick="applyBioCore(1, 'Turmeric', 'DrugB', 0.9)">
                    <strong>üåø Turmeric + DrugB</strong><br>
                    <small>Balancing Effect (Synergy: 0.9)</small>
                </div>
                <div class="control-button" onclick="applyBioCore(2, 'Ginseng', 'DrugC', 0.7)">
                    <strong>üåø Ginseng + DrugC</strong><br>
                    <small>Activating Effect (Synergy: 0.7)</small>
                </div>
                <div class="control-button" onclick="applyBioCore(3, 'Bacopa', 'DrugD', 0.6)">
                    <strong>üåø Bacopa + DrugD</strong><br>
                    <small>Cognitive Enhancement (Synergy: 0.6)</small>
                </div>
                <div class="control-button" onclick="applyBioCore(4, 'Rhodiola', 'DrugE', 0.8)">
                    <strong>üåø Rhodiola + DrugE</strong><br>
                    <small>Stress Resistance (Synergy: 0.8)</small>
                </div>
                <div class="control-button" onclick="optimizeSystem()">
                    <strong>‚ö° OPTIMIZE SYSTEM</strong><br>
                    <small>AI-Powered Optimization</small>
                </div>
            </div>
        </div>

        <!-- ACTION BUTTONS -->
        <div class="action-buttons">
            <button class="action-button" onclick="startSimulation()">üöÄ START SIMULATION</button>
            <button class="action-button" onclick="pauseSimulation()">‚è∏Ô∏è PAUSE SIMULATION</button>
            <button class="action-button" onclick="resetSystem()">üîÑ RESET SYSTEM</button>
            <button class="action-button" onclick="exportData()">üìä EXPORT DATA</button>
        </div>
    </div>

    <script>
        // System State
        let systemState = {
            zones: [
                { id: 0, name: "Downtown", activity: 0.3, state: "CALM" },
                { id: 1, name: "Industrial", activity: 0.6, state: "OVERSTIMULATED" },
                { id: 2, name: "Residential", activity: 0.2, state: "CALM" },
                { id: 3, name: "Commercial", activity: 0.8, state: "EMERGENT" },
                { id: 4, name: "Parks", activity: 0.4, state: "CALM" }
            ],
            biocoreEffects: 0,
            lunaInteractions: 1,
            simulationRunning: false,
            simulationInterval: null
        };

        // Initialize Dashboard
        function initializeDashboard() {
            updateZonesDisplay();
            updateMetrics();
            addLunaMessage("üåô System initialized successfully! All zones are online and ready for BioCore interventions.");
        }

        // Update Zones Display
        function updateZonesDisplay() {
            const zonesGrid = document.getElementById('zones-grid');
            zonesGrid.innerHTML = '';
            
            systemState.zones.forEach(zone => {
                const zoneCard = document.createElement('div');
                zoneCard.className = 'zone-card';
                zoneCard.innerHTML = `
                    <div class="zone-id">Zone ${zone.id}</div>
                    <div class="zone-name">${zone.name}</div>
                    <div class="zone-activity">${zone.activity.toFixed(3)}</div>
                    <div class="zone-state state-${zone.state.toLowerCase()}">${zone.state}</div>
                `;
                zonesGrid.appendChild(zoneCard);
            });
        }

        // Update Metrics
        function updateMetrics() {
            const avgActivity = systemState.zones.reduce((sum, zone) => sum + zone.activity, 0) / systemState.zones.length;
            document.getElementById('system-health').textContent = avgActivity.toFixed(3);
            document.getElementById('active-zones').textContent = systemState.zones.length;
            document.getElementById('biocore-effects').textContent = systemState.biocoreEffects;
            document.getElementById('luna-interactions').textContent = systemState.lunaInteractions;
        }

        // Send Chat Message
        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (message === '') return;
            
            addUserMessage(message);
            processLunaResponse(message);
            input.value = '';
            
            systemState.lunaInteractions++;
            updateMetrics();
        }

        // Add User Message
        function addUserMessage(message) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Add Luna Message
        function addLunaMessage(message) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message luna-message';
            messageDiv.innerHTML = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Process Luna Response
        function processLunaResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('status') || lowerMessage.includes('how are')) {
                const health = (systemState.zones.reduce((sum, zone) => sum + zone.activity, 0) / systemState.zones.length).toFixed(3);
                addLunaMessage(`üåä System health is currently at ${health}. ${getSystemStatusMessage()}`);
            } else if (lowerMessage.includes('zone')) {
                const zoneStatus = systemState.zones.map(z => `Zone ${z.id} (${z.name}): ${z.state} (${z.activity.toFixed(3)})`).join('<br>');
                addLunaMessage(`üèôÔ∏è Current zone status:<br>${zoneStatus}`);
            } else if (lowerMessage.includes('biocore') || lowerMessage.includes('effect')) {
                addLunaMessage(`üåø BioCore system is ready! ${systemState.biocoreEffects} effects applied. Use the control panel to apply plant-drug combinations.`);
            } else if (lowerMessage.includes('optimize') || lowerMessage.includes('improve')) {
                addLunaMessage(`‚ö° I recommend applying calming effects to overstimulated zones and activating effects to calm zones. Current system health needs optimization.`);
            } else if (lowerMessage.includes('help')) {
                addLunaMessage(`üåô I can help you with:<br>‚Ä¢ System status<br>‚Ä¢ Zone information<br>‚Ä¢ BioCore effects<br>‚Ä¢ Optimization recommendations<br>‚Ä¢ Simulation control<br>Try asking about any of these!`);
            } else {
                addLunaMessage(`üåô I understand you're asking about: "${message}". The system is functioning normally. You can ask me about system status, zones, BioCore effects, or optimization.`);
            }
        }

        // Get System Status Message
        function getSystemStatusMessage() {
            const calmZones = systemState.zones.filter(z => z.state === 'CALM').length;
            const overstimulatedZones = systemState.zones.filter(z => z.state === 'OVERSTIMULATED').length;
            const emergentZones = systemState.zones.filter(z => z.state === 'EMERGENT').length;
            
            if (emergentZones > 0) {
                return `${emergentZones} zones need immediate attention!`;
            } else if (overstimulatedZones > 2) {
                return `Multiple zones are overstimulated. Consider applying calming BioCore effects.`;
            } else if (calmZones > 3) {
                return `System is stable. Consider applying activating BioCore effects to improve productivity.`;
            } else {
                return `System is balanced and operating normally.`;
            }
        }

        // Apply BioCore Effect
        function applyBioCore(zoneId, plant, drug, synergy) {
            const zone = systemState.zones.find(z => z.id === zoneId);
            if (!zone) return;
            
            // Apply effect (simplified calculation)
            const effect = (synergy * 0.2 - 0.1);
            zone.activity = Math.max(0, Math.min(1, zone.activity + effect));
            
            // Update zone state
            if (zone.activity < 0.4) {
                zone.state = 'CALM';
            } else if (zone.activity < 0.7) {
                zone.state = 'OVERSTIMULATED';
            } else {
                zone.state = 'EMERGENT';
            }
            
            systemState.biocoreEffects++;
            
            updateZonesDisplay();
            updateMetrics();
            
            addLunaMessage(`üåø Applied ${plant} + ${drug} to Zone ${zoneId} (${zone.name}). Effect magnitude: ${effect.toFixed(3)}. New state: ${zone.state}`);
        }

        // Optimize System
        function optimizeSystem() {
            systemState.zones.forEach(zone => {
                if (zone.state === 'OVERSTIMULATED') {
                    zone.activity = Math.max(0.3, zone.activity - 0.1);
                } else if (zone.state === 'CALM') {
                    zone.activity = Math.min(0.6, zone.activity + 0.1);
                }
                
                // Update state
                if (zone.activity < 0.4) {
                    zone.state = 'CALM';
                } else if (zone.activity < 0.7) {
                    zone.state = 'OVERSTIMULATED';
                } else {
                    zone.state = 'EMERGENT';
                }
            });
            
            updateZonesDisplay();
            updateMetrics();
            
            addLunaMessage(`‚ö° System optimization complete! Applied intelligent balancing to all zones based on their current states.`);
        }

        // Start Simulation
        function startSimulation() {
            if (systemState.simulationRunning) return;
            
            systemState.simulationRunning = true;
            systemState.simulationInterval = setInterval(() => {
                systemState.zones.forEach(zone => {
                    // Add small random fluctuations
                    const fluctuation = (Math.random() - 0.5) * 0.02;
                    zone.activity = Math.max(0, Math.min(1, zone.activity + fluctuation));
                    
                    // Update state
                    if (zone.activity < 0.4) {
                        zone.state = 'CALM';
                    } else if (zone.activity < 0.7) {
                        zone.state = 'OVERSTIMULATED';
                    } else {
                        zone.state = 'EMERGENT';
                    }
                });
                
                updateZonesDisplay();
                updateMetrics();
            }, 2000);
            
            addLunaMessage(`üöÄ Simulation started! Zones are now evolving in real-time with homeostatic regulation.`);
        }

        // Pause Simulation
        function pauseSimulation() {
            if (!systemState.simulationRunning) return;
            
            systemState.simulationRunning = false;
            if (systemState.simulationInterval) {
                clearInterval(systemState.simulationInterval);
                systemState.simulationInterval = null;
            }
            
            addLunaMessage(`‚è∏Ô∏è Simulation paused. System state is frozen.`);
        }

        // Reset System
        function resetSystem() {
            pauseSimulation();
            
            systemState.zones = [
                { id: 0, name: "Downtown", activity: 0.3, state: "CALM" },
                { id: 1, name: "Industrial", activity: 0.6, state: "OVERSTIMULATED" },
                { id: 2, name: "Residential", activity: 0.2, state: "CALM" },
                { id: 3, name: "Commercial", activity: 0.8, state: "EMERGENT" },
                { id: 4, name: "Parks", activity: 0.4, state: "CALM" }
            ];
            
            systemState.biocoreEffects = 0;
            systemState.lunaInteractions = 1;
            
            updateZonesDisplay();
            updateMetrics();
            
            addLunaMessage(`üîÑ System reset to initial state. All zones restored to default values.`);
        }

        // Export Data
        function exportData() {
            const data = {
                timestamp: new Date().toISOString(),
                systemHealth: (systemState.zones.reduce((sum, zone) => sum + zone.activity, 0) / systemState.zones.length).toFixed(3),
                zones: systemState.zones,
                biocoreEffects: systemState.biocoreEffects,
                lunaInteractions: systemState.lunaInteractions,
                simulationRunning: systemState.simulationRunning
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `bhcs-system-data-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            addLunaMessage(`üìä System data exported successfully! File contains current state, metrics, and configuration.`);
        }

        // Handle Enter key in chat
        document.getElementById('chat-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Initialize on load
        window.onload = function() {
            initializeDashboard();
        };
    </script>
</body>
</html>
